<!DOCTYPE html>
<html>
<head>
  <title>AI Personal Assistant</title>
  <style>
    body { font-family: Arial; text-align: center; background: #f2f2f2; padding: 20px; }
    input, button, select { padding: 10px; margin: 5px; border-radius: 5px; }
    ul { list-style: none; padding-left: 0; }
    li { margin: 5px 0; }
    .section-title { color: #333; font-weight: bold; margin-top: 20px; }
    /* popup style */
    .popup {
      position: fixed;
      top: 30%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border: 2px solid #333;
      padding: 20px;
      z-index: 1000;
      text-align: center;
      box-shadow: 0px 0px 10px #000;
    }
    .popup button { margin: 5px; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>

<h1>ðŸ¤– AI Personal Assistant</h1>
<p>Manage tasks, reminders, and voice commands</p>

<select id="sectionSelect">
  <option value="Study">Study</option>
  <option value="Workout">Workout</option>
  <option value="Personal">Personal</option>
</select>

<input id="taskInput" placeholder="Enter task">
<input id="timeInput" type="time">
<br>
<button onclick="enableSound()">Enable Sound ðŸ”Š</button>
<button onclick="addTask()">Add Task</button>
<button onclick="startVoice()">ðŸŽ¤ Voice Command</button>

<h2 class="section-title">Study Section</h2>
<ul id="Study"></ul>
<h2 class="section-title">Workout Section</h2>
<ul id="Workout"></ul>
<h2 class="section-title">Personal Section</h2>
<ul id="Personal"></ul>

<audio id="alarmSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>

<script>
let soundEnabled = false;

<script>
let soundEnabled = false;

// Enable sound
function enableSound() {
  soundEnabled = true;
  alert("Sound Enabled! Now add a task.");
}

// Add task function
function addTask(taskInput, timeInput, sectionInput) {
  // ... your fixed addTask code here ...
}

// Show tasks
function showTasks(section) {
  const ul = document.getElementById(section);
  const count = ul.children.length;
  if(count === 0) { alert(section + " has no tasks."); return; }
  let msg = section + " tasks (" + count + "):\n";
  for (let i = 0; i < count; i++) {
    msg += "- " + ul.children[i].textContent.replace("Delete","").trim() + "\n";
  }
  alert(msg);
}

// âœ… Voice command
function startVoice() {
  if (!('webkitSpeechRecognition' in window)) {
    alert("Your browser does not support voice commands. Use Chrome.");
    return;
  }

  const recognition = new webkitSpeechRecognition();
  recognition.lang = "en-US";
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;

  recognition.onstart = () => console.log("ðŸŽ¤ Voice recognition started.");
  recognition.onerror = (event) => alert("Error: " + event.error);
  recognition.onresult = (event) => {
    const command = event.results[0][0].transcript.toLowerCase();
    console.log("You said: " + command);
    handleCommand(command);
  };

  recognition.start();
}

// Handle voice commands
function handleCommand(cmd) {
  cmd = cmd.toLowerCase();
  if(cmd.includes("hello") || cmd.includes("hi")) {
    alert("Hello! I am your assistant ðŸ¤–");
    return;
  }
  if(cmd.includes("tasks today") || cmd.includes("my tasks")) {
    const total =
      document.getElementById("Study").children.length +
      document.getElementById("Workout").children.length +
      document.getElementById("Personal").children.length;
    alert("You have " + total + " tasks today");
    return;
  }
  if(cmd.includes("show")) {
    if(cmd.includes("study")) showTasks("Study");
    else if(cmd.includes("workout")) showTasks("Workout");
    else if(cmd.includes("personal")) showTasks("Personal");
    else alert("Which section? Study / Workout / Personal");
    return;
  }
  if(cmd.includes("add") || cmd.includes("remind") || cmd.includes("set")) {
    let section = "Personal";
    if(cmd.includes("study")) section="Study";
    if(cmd.includes("workout")) section="Workout";
    if(cmd.includes("personal")) section="Personal";

    let timeMatch = cmd.match(/(\d{1,2}[:.]\d{2})/);
    let time = "";
    if(timeMatch) time = timeMatch[1].replace(".", ":");
    else {
      let timeAMPM = cmd.match(/at (\d{1,2}) ?(am|pm)/);
      if(timeAMPM) {
        let hour = parseInt(timeAMPM[1]);
        if(timeAMPM[2]==="pm" && hour<12) hour+=12;
        if(timeAMPM[2]==="am" && hour===12) hour=0;
        time = (hour<10?"0"+hour:hour)+":00";
      } else {
        time = prompt("Enter time for task (HH:MM)");
      }
    }

    let task="";
    if(cmd.includes("task")) task=cmd.split("task")[1].split("at")[0].trim();
    else if(cmd.includes("remind me to")) task=cmd.split("remind me to")[1].split("at")[0].trim();
    else task = prompt("Enter task name:");

    addTask(task, time, section);
    return;
  }
  alert("Command not recognized ðŸ¤”");
}
</script>
