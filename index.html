<script>
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];

function saveTasks() {
  localStorage.setItem("tasks", JSON.stringify(tasks));
}

function renderTasks() {
  document.getElementById("taskList").innerHTML = "";
  tasks.forEach((task, index) => {
    let li = document.createElement("li");
    li.innerHTML = `${task.text} ⏰ ${task.time} <button onclick="removeTask(${index})">❌</button>`;
    document.getElementById("taskList").appendChild(li);
  });
}

function addTask() {
  let taskText = document.getElementById("taskInput").value;
  let taskTime = document.getElementById("timeInput").value;
  if(taskText === "" || taskTime === "") return alert("Enter task and time!");

  tasks.push({ text: taskText, time: taskTime, alerted: false });
  saveTasks();
  renderTasks();
  document.getElementById("taskInput").value = "";
  document.getElementById("timeInput").value = "";
}

function removeTask(index) {
  tasks.splice(index, 1);
  saveTasks();
  renderTasks();
}

// Check every second for reminders
setInterval(() => {
  let now = new Date();
  let currentTime = now.toTimeString().slice(0,5); // HH:MM
  tasks.forEach((task) => {
    if(task.time === currentTime && !task.alerted){
      alert(`⏰ Reminder: ${task.text}`);
      task.alerted = true; // prevent alert repeating
      saveTasks();
    }
  });
}, 1000);

renderTasks();
</script>
